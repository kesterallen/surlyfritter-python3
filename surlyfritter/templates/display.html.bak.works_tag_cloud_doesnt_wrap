{% extends "base.html" %}

{% block title %} {{ super() }} Pictures Page {% endblock %}

{% block head %} 
  {{ super() }}
  {% if pictures and pictures|length == 1 %}
    <script>
      document.onkeyup = function (e) {
        e = e || window.event;
        var key = e.which;
        if(key == 39) { // right arrow
          document.getElementById("next_picture").click();
          return false;  
        } else if(key == 37) { // left arrow
          document.getElementById("prev_picture").click();
          return false;  
        }
      }
    </script>
  {% endif %}
{% endblock %}

{% block content %}
  {{ super() }}

  <div class="container-md">
    {% if pictures %}
      {% for picture in pictures %}
        <!-- Display picture and metadata -->
        <br/>
        <div class="row">

          <div class="col-sm-10 col-lg-8">
            <!-- Prev/Random/Next buttons for mobile -->
            {% if pictures|length == 1 %}
              <div class="row d-lg-none"> <!-- Hide on screens wider than lg -->
                <a class="btn btn-primary col-sm-3 offset-sm-1" href="/p/{{picture.prev_pic.imgp_id}}" role="button">
                  <div>Previous</div>
                </a>
                <a class="btn btn-primary col-sm-3 offset-sm-1" href="/random" role="button">
                  <div>Random</div>
                </a>
                <a class="right btn btn-primary col-sm-3 offset-sm-1" href="/p/{{picture.prev_pic.imgp_id}}" role="button">
                  <div>Next</div>
                </a>
              </div>
              <br/>
            {% endif %}

            <!-- The image -->
            <a href="/p/{{picture.imgp_id}}">
              <img class="img-fluid" src="{{picture.img_url}}">
            </a>
          </div>

          <!-- Show date, tag(s), comment(s), add tag/comment forms, & tag cloud -->
          <div class="col-sm-10 col-lg-4 text-center">
            {{picture.date_display}}

            <ul class="list-inline"> 
              {% for t in picture.tags %}
                <li class="list-inline-item">
                  <a href="/tags/{{t.text}}">{{t.text}}</a>
                </li>
              {% endfor %}
            </ul>

            <ul class="list-unstyled"> 
              {% for c in picture.comments %}<li>{{c.text}}</li>{% endfor %}
            </ul>

            <!-- 
            If this is a single picture, show the forms to add comments/tags
            and the tag cloud.
            -->
            {% if pictures|length == 1 %}
              <hr/>
              {% include 'add_tag_comment.html' %}
              <hr/>
              {% include 'tag_cloud.html' %}
            {% endif %}
          </div> 

        </div>
      {% endfor %}
    {% else %}
      <!-- Empty picture. Show tag cloud here. -->
      (No pictures found for '{{request.path}}')
      {% include 'tag_cloud.html' %}
    {% endif %}

  </div>
{% endblock %}

{% block footer %} {{ super() }} {% endblock %}
